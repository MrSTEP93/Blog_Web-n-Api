# Запуск Flask-сервиса из Docker-контейнера
## Пошаговая инструкция для ОС Windows
[*Можно разместить ссылку на отдельную инструкцию для Linux*]

### Подготовка окружения
- Установить [Docker Desktop](https://www.docker.com/products/docker-desktop/) для Windows.  
- Распаковать архив с проектом в определенный каталог (например, <ins>D:\containers\project01</ins>).   
### Шаги для запуска:
#### 1. Откройте командную строку ####  
Для этого нажмите сочетание клавиш **Win** + **R**, введите **cmd** и нажмите **Enter**.  
*Альтернативный вариант - запустить консоль **PowerShell***.

#### 2. Перейдите в папку проекта ####
Введите в окно командной строки
```cmd
cd D:\containers\project01
```
#### 3. Выполните команду на сборку и запуск контейнера ####  
```cmd
docker-compose up --build -d
```
Первая сборка может занять несколько минут из-за загрузки образов и зависимостей.  

Ключ **-d** позволит запустить контейнер в фоновом режиме и освободить окно консоли для ввода других команд.  
Если вы запустили контейнер без ключа **-d**, вам понадобится открыть еще один экземпляр cmd или PowerShell, чтобы проверить его статус.  

#### 4. Проверьте статус контейнера ####  
```cmd
docker-compose ps
```
В столбце <ins>STATUS</ins> должен быть указан статус **Up** (данный статус означает, что контейнер работает).  
Статус **Exited** будет означать, что контейнер остановлен.

#### 5. Откройте браузер ####  
Чтобы начать работу с приложением, перейдите по адресу: <http://localhost:5000>  

#### 6. Остановка приложения ####  
Когда работа с приложением будет завершена, контейнер можно остановить следующей командой:  
```cmd
docker-compose down
```

-------  

## Диагностика проблем ##
### Проблема 1: Приложение не открывается в браузере ###  
**Решение:**  
1.1. Проверьте, что контейнер запущен: ```docker-compose ps```  
1.2. Проверьте логи (журналы) на наличие ошибок: ```docker-compose logs``` (подробнее о логах - см. [FAQ #5](#вопрос-5-как-посмотреть-логи))  
1.3. Перейдите к решению [проблемы #2](#проблема-2-порты-используемые-в-контейнере-заняты)  

### Проблема 2: Порты, используемые в контейнере, заняты ###
**Решение:**  
Проверьте, использует ли какой-то сервис в вашей ОС порт, который должен использоваться в контейнере (например, **5000**):  
```cmd
netstat -ano | findstr :5000
```

Если порт занят, для использования в контейнере можно указать другой порт:  
Откройте текстовым редактором (например, Блокнот или Notepad++) файл <ins>docker-compose.yml</ins>. Найдите там следующие строки
```
ports:
  - "5000:5000" 
```  
Здесь первое значение (до двоеточия) указывает порт, используемый в ОС, а второе - порт, используемый в приложении. Вместо первого значения можно указать новый порт, например 8050 или 5500. Важно, чтобы этот порт был свободен в вашей системе.  
Если в файле <ins>docker-compose.yml</ins> нет секции с указанием портов, её следует туда добавить (вставить в файл две строки, указанные выше).  
После этого нужно выполнить перезапуск контейнера (см. [FAQ #4](#вопрос-4-как-перезапустить-контейнер-docker)) и проверить работу приложения, открыв в браузере адрес с использованием нового порта, то есть <http://localhost:8050> или <http://localhost:5500>  

### Проблема 3: Ошибки при сборке (build error) ###
**Решение:**  
Убедитесь, что в папке проекта существуют файлы  
-requirements.txt  
-Dockerfile  
Восстановите недостающие файлы и выполните перезапуск контейнера: см. [FAQ #4](#вопрос-4-как-перезапустить-контейнер-docker)).  

Проверьте логи контейнера на предмет ошибок: см. [FAQ #5](#вопрос-5-как-посмотреть-логи).  

------

## FAQ (Часто задаваемые вопросы) ##
### Вопрос 1: Как посмотреть информацию о запущенных контейнерах? ###  
**Ответ:** Используйте следующие команды в командной строке:  
```
# Показать все запущенные контейнеры
docker ps

# Показать ВСЕ контейнеры (включая остановленные)
docker ps -a

# Показать контейнеры текущего проекта Docker Compose
docker-compose ps

# Подробная информация о конкретном контейнере
docker inspect имя_контейнера
```  
Кроме этого, можно открыть приложение Docker Desktop и перейти раздел Containers, где можно видеть статус контейнеров и управлять ими.  

### Вопрос 2: Docker пишет "ports are not available" или "port already allocated". Что делать? ###  
**Ответ:**  
Это значит, что порт, который должен использовать в вашей ОС для доступа к сервису внутри контейнера, занят другим приложением.  
**Решение:** см. решение [проблемы #2](#проблема-2-порты-используемые-в-контейнере-заняты).  

### Вопрос 3: Любая команда docker выдает ошибку, которая заканчивается фразой "The system cannot find the file specified" ###   
**Возможные причины:**
Приложение Docker Desktop не запущено - запустите его через ярлык с рабочего стола из меню Пуск и дождитесь запуска движка Docker.  
Убедитесь, что иконка Docker в системном трее (рядом с часами) не показывает восклицательный знак. Тогда нужно проверить, о чем хочет сказать приложение.  

### Вопрос 4: Как перезапустить контейнер Docker? ###
Выполните остановку контейнера и повторный запуск, введя следующие команды:  
```cmd
docker-compose down
docker-compose up -d
```

К этим действиям можно добавить полную пересборку (без кеширования):  
```cmd
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### Вопрос 5: Как посмотреть логи ###
Воспользуйтесь командой ```docker-compose logs```  
Для сохранения логов в текстовый файл используйте ```docker-compose logs > logs.txt```  

Сюда же можно отнести вопрос: **Как увидеть логи приложения в реальном времени?**  
**Ответ:**  
Используйте следующую команду:
```cmd
docker-compose logs -f --tail=50
``` 
Что обозначают указанные в команде флаги?  
-**-f** - следить за логами в реальном времени  
-**--tail=50** - показать последние 50 строк  

## Поддержка ##
Если у вас остались проблемы или вопросы, напишите нам, приложив к письму логи, скриншоты и описание действий, которые привели к проблеме. 
Мы обязательно разберемся и поможем, чтобы вы без проблем могли пользоваться нашим сервисом!


*контакты техподдержки*  
*компания, копирайт*  
