# Пошаговая инструкция по запуску Flask-сервиса из Docker-контейнера в ОС Windows
[Инструкция для Linux](можно_подготовить_отдельно)

### Подготовка окружения
- Установить [Docker Desktop](https://www.docker.com/products/docker-desktop/) для Windows  
- Распаковать архив с проектом в определенный каталог (например, <ins>D:\containers\project</ins>)   
### Шаги для запуска:
#### 1. Откройте командную строку ####  
Для этого нажмите сочетание клавиш **Win** + **R**, введите **cmd** и нажмите **Enter**.  
*Альтернативный вариант - запустить консоль **PowerShell***

#### 2. Перейдите в папку проекта ####
Введите в окно командной строки
```cmd
cd D:\containers\project
```
#### 3. Выполните команду на сборку и запуск контейнера ####  
```cmd
docker-compose up --build -d
```  
Ключ **-d** позволит запустить контейнер в фоновом режиме и освободить окно консоли для ввода других команд.  
Если вы запустили контейнер без ключа **-d**, вам понадобится открыть еще один экземпляр cmd или PowerShell, чтобы проверить его статус.  

#### 4. Проверьте статус контейнера ####  
```cmd
docker-compose ps
```
В столбце <ins>STATUS</ins> должен быть указан статус **Up** (данный статус означает, что контейнер работает) 

#### 5. Откройте браузер. ####  
Чтобы начать работу с сервисом, перейдите по адресу: <http://localhost:5000>  

#### 6. Остановка приложения ####  
Когда работа с сервисом будет завершена, контейнер можно остановить следующей командой:  
```cmd
docker-compose down
```  
-------  
## Диагностика проблем ##
#### Проблема 1: Приложение не открывается в браузере ####  
**Решение:**  
1.1. Проверьте, что контейнер запущен: ```docker-compose ps```  
1.2. Проверьте логи на наличие ошибок: ```docker-compose logs```  
1.3. Перейдите к решению [проблемы #2](#проблема-2-порты-используемые-в-приложении-заняты)

#### Проблема 2: Порты, используемые в приложении, заняты ####
**Решение:**  
Проверьте, использует ли какой-то сервис в вашей ОС порт, который должен использоваться в приложении (например, **5000**):  
```cmd
netstat -ano | findstr :5000
```

Если порт занят, для использования в приложении можно указать другой порт:
Откройте текстовым редактором (например, Блокнот или Notepad++) файл <ins>docker-compose.yml</ins>. Найдите там следующие строки
```
ports:
  - "5000:5000" 
```  
Здесь первое значение (до двоеточия) указывает порт, используемый в ОС, а второе - порт, используемый в контейнере. Вместо первого значения можно указать другое, например 8050 или 5500. Важно, чтобы этот порт был свободен в вашей системе.  
Если в файле нет секции с указанием портов, её следует туда добавить (вставить в файл строки, указанные выше).  
После этого нужно выполнить перезапуск контейнера (См. [FAQ #4](#вопрос-4-как-перезапустить-контейнер-docker)) и проверить работу приложения, открыв в браузере адрес <http://localhost:8050>   

#### Проблема 3: Ошибки при сборке (build error) ####
**Решение:**  
Убедитесь, что в папке проекта существуют файлы  
-requirements.txt  
-Dockerfile  
Восстановите недостающие файлы и выполните перезапуск контейнера (См. [FAQ #4](#вопрос-4-как-перезапустить-контейнер-docker)).

------

## FAQ (Часто задаваемые вопросы) ##
#### Вопрос 1: Как посмотреть информацию о запущенных контейнерах? ####  
**Ответ:** Используйте следующие команды в командной строке:  
```
# Показать все запущенные контейнеры
docker ps

# Показать ВСЕ контейнеры (включая остановленные)
docker ps -a

# Показать контейнеры текущего проекта Docker Compose
docker-compose ps

# Подробная информация о конкретном контейнере
docker inspect имя_контейнера
```  
Кроме этого, можно открыть приложение Docker Desktop и перейти раздел Containers, где можно видеть статус контейнеров и управлять ими.  

#### Вопрос 2: Docker пишет "ports are not available" или "port already allocated". Что делать? ####  
**Ответ:**  
Это значит, что порт 5000 занят другим приложением.  
**Решение:** см. решение [проблемы #2](#проблема-2-порты-используемые-в-приложении-заняты).

#### Вопрос 3: Любая команда docker выдает ошибку, которая заканчивается фразой "The system cannot find the file specified" ####   
**Возможные причины:**
Docker Desktop не запущен - запустите его через ярлык с рабочего стола из меню Пуск и дождитесь запуска движка Docker.

#### Вопрос 4: Как перезапустить контейнер Docker? ####
Выполните остановку контейнера, полную пересборку (без кеширования), и повторный запуск, введя следующие команды:  
```cmd
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

#### Вопрос 5: Как увидеть логи приложения в реальном времени? ####
**Ответ:**
Используйте следующую команду:
```cmd
docker-compose logs -f --tail=50
``` 
Что обозначают указанные в команде флаги?  
-**-f** - следить за логами в реальном времени  
-**--tail=50** - показать последние 50 строк  

## Поддержка ##
Если у вас остались проблемы или вопросы, напишите нам, приложив к письму логи, скриншоты и описание действий, которые привели к проблеме. 
Мы обязательно разберемся и поможем, чтобы вы могли наслаждаться нашим сервисом!


